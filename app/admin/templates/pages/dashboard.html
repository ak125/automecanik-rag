{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<div class="space-y-6">
    <h1 class="text-2xl font-bold">RAG Knowledge Dashboard</h1>

    <div class="grid grid-cols-5 gap-4">
        <div class="bg-white rounded shadow p-4">
            <div class="text-sm text-gray-500">Total</div>
            <div class="text-3xl font-bold">{{ total }}</div>
        </div>
        <div class="bg-white rounded shadow p-4 border-l-4 border-green-500">
            <div class="text-sm text-gray-500">L1</div>
            <div class="text-3xl font-bold text-green-500">{{ by_truth_level.L1 }}</div>
        </div>
        <div class="bg-white rounded shadow p-4 border-l-4 border-blue-500">
            <div class="text-sm text-gray-500">L2</div>
            <div class="text-3xl font-bold text-blue-500">{{ by_truth_level.L2 }}</div>
        </div>
        <div class="bg-white rounded shadow p-4 border-l-4 border-amber-500">
            <div class="text-sm text-gray-500">L3</div>
            <div class="text-3xl font-bold text-amber-500">{{ by_truth_level.L3 }}</div>
        </div>
        <div class="bg-white rounded shadow p-4 border-l-4 border-red-500">
            <div class="text-sm text-gray-500">L4</div>
            <div class="text-3xl font-bold text-red-500">{{ by_truth_level.L4 }}</div>
        </div>
    </div>

    <div class="bg-white rounded shadow p-4">
        <h2 class="font-semibold mb-2">Par Type</h2>
        <div class="flex flex-wrap gap-2">
            {% for type, count in by_source_type.items() %}
            <span class="px-3 py-1 bg-gray-100 rounded">{{ count }} {{ type }}</span>
            {% endfor %}
        </div>
    </div>

    <div class="bg-white rounded shadow">
        <div class="p-4 border-b flex justify-between">
            <h2 class="font-semibold">Documents Recents</h2>
            <a href="/admin/documents" class="text-blue-600 text-sm">Voir tous</a>
        </div>
        <ul class="divide-y">
            {% for doc in recent_documents %}
            <li class="p-4 hover:bg-gray-50">
                <a href="/admin/documents/{{ doc.id }}">{{ doc.title }} <span class="text-xs px-2 py-0.5 rounded text-white {% if doc.truth_level == 'L1' %}bg-green-500{% elif doc.truth_level == 'L2' %}bg-blue-500{% elif doc.truth_level == 'L3' %}bg-amber-500{% else %}bg-red-500{% endif %}">{{ doc.truth_level }}</span></a>
            </li>
            {% else %}
            <li class="p-4 text-gray-500">Aucun document</li>
            {% endfor %}
        </ul>
    </div>

    <div class="flex gap-4">
        <a href="/admin/documents/new" class="px-4 py-2 bg-blue-600 text-white rounded">+ Nouveau</a>
        <a href="/admin/chat" class="px-4 py-2 bg-gray-600 text-white rounded">Chat</a>
        <a href="/admin/search" class="px-4 py-2 bg-gray-600 text-white rounded">Search</a>
    </div>
</div>
{% endblock %}
